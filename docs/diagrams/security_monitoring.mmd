graph LR
  subgraph Security_Monitoring
    Monitor[Security Monitor]
    Alert[Alert System]
    Remediate[Remediation Service]
  end

  subgraph Azure_Resources
    VM[Confidential VM]
    Storage[Secure Storage]
    KV[Key Vault]
    NSG[Network Security]
  end

  subgraph Security_Events
    Auth[Authentication]
    Access[Access Control]
    Network[Network Activity]
    Config[Configuration]
  end

  Monitor -->|Monitor| VM
  Monitor -->|Monitor| Storage
  Monitor -->|Monitor| KV
  Monitor -->|Monitor| NSG

  VM -->|Events| Auth
  Storage -->|Events| Access
  KV -->|Events| Access
  NSG -->|Events| Network

  Auth -->|Report| Monitor
  Access -->|Report| Monitor
  Network -->|Report| Monitor
  Config -->|Report| Monitor

  Monitor -->|Trigger| Alert
  Alert -->|Notify| Remediate
  Remediate -->|Fix| VM
  Remediate -->|Fix| Storage
  Remediate -->|Fix| KV
  Remediate -->|Fix| NSG
